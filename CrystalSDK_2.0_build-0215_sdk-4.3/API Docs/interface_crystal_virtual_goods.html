<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Crystal SDK for iOS: CrystalVirtualGoods Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#properties">Properties</a>  </div>
  <div class="headertitle">
<h1>CrystalVirtualGoods Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="CrystalVirtualGoods" -->
<p><code>#import &lt;<a class="el" href="_crystal_virtual_goods_8h_source.html">CrystalVirtualGoods.h</a>&gt;</code></p>

<p><a href="class_crystal_virtual_goods-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">(void)&nbsp;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interface_crystal_virtual_goods.html#a00d41c367f983e89b1370f947bbf8ae6">startUpdating</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Instructs the SDK to start keeping the <a class="el" href="interface_crystal_player.html" title="The interface to the Crystal gifting functionality and player info This class updates automatically f...">CrystalPlayer</a> class up-to-date with the current player's info Because this method initiates network traffic and server load it is important that apps refrain from calling the method unless virtual goods and currencies are implemented.  <a href="#a00d41c367f983e89b1370f947bbf8ae6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">(void)&nbsp;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interface_crystal_virtual_goods.html#ad628cda33c85c0ea8a932332f06a1abf">updateNow</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Instructs the SDK to update the <a class="el" href="interface_crystal_virtual_goods.html">CrystalVirtualGoods</a> info as soon as possible Ordinarily any activity relating to virtual goods or currencies inside the Crystal UI will automatically instruct <a class="el" href="interface_crystal_virtual_goods.html">CrystalVirtualGoods</a> to update itself. The same is true when using APIs like postGoods:. If a post fails the client should always retry via the post calls and not call updateNow. updateNow will retrieve updated information from the server and any information previously posted will be lost. It should be rare that the client will need to call this method but it is added for completeness.  <a href="#ad628cda33c85c0ea8a932332f06a1abf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">(BOOL)&nbsp;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interface_crystal_virtual_goods.html#a9486d5f488eb962f401815daff86811f">virtualGoodsInfoIsUpToDate</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns YES if the info for the curent player's virtual goods info is up-to-date Crystal will make every effort to keep the data up-to-date, so as long as the device has an Internet connection it should be rare that this method returns NO.  <a href="#a9486d5f488eb962f401815daff86811f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">(void)&nbsp;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interface_crystal_virtual_goods.html#a3c492df8fcf36517289f4986a0e643ba">postGoods:</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Post changes to the user's virtual goods record back to the server Use this method to post one or more changes to the user's virtual goods to the server. Changes will only be made to the virtual good that are supplied, and more than one virtual good can be updated at once. There is no need to replicate the information stored in the goods property in full. To avoid server load it is recommended to combine changes into one call by adding the info to the same dictionary. To remove the good from the user supply a 0 for the number of goods owned. When the virtual goods have been updated the client will be informed via crystalVirtualGoodsInfoUpdatedWithSuccess: and the results reflected in the goods property.  <a href="#a3c492df8fcf36517289f4986a0e643ba"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">(void)&nbsp;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interface_crystal_virtual_goods.html#ad5b441744dd3b2a7bb36380b9a0ad9ca">postBalances:</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Post changes to the user's balances back to the server Use this method to post one or more changes to the user's wallet balances to the server. Changes will only be made to the balances that are supplied, and more than one balance can be updated at once. There is no need to replicate the information stored in the balances property in full. To avoid server load it is recommended to combine changes into one call by adding the info to the same dictionary. When the virtual currencies have been updated the client will be informed via crystalVirtualGoodsInfoUpdatedWithSuccess: and the results reflected in the goods property.  <a href="#ad5b441744dd3b2a7bb36380b9a0ad9ca"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">(void)&nbsp;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interface_crystal_virtual_goods.html#a02e594e54c25cec743faf73d61d84537">postGoods:andBalances:</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Post both goods and balances changes to the server Where the client needs to post changes to both currencies and goods it is recommended that it uses this method to avoid excessive server load.  <a href="#a02e594e54c25cec743faf73d61d84537"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">(void)&nbsp;</td><td class="memItemRight" valign="bottom">- <a class="el" href="interface_crystal_virtual_goods.html#a90d3d0cae26cf956cbe9ff6831206b67">setLockedGoods:</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set a list of goods that are not selectable and are shown with a 'locked' icon in the Crystal UI This method works differently from postGoods: and postBalances: in that it's not possible to 'update' items peacemeal. The client must send all locked goods in one call, and can remove the locks by passing nil as the parameter.  <a href="#a90d3d0cae26cf956cbe9ff6831206b67"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">(<a class="el" href="interface_crystal_virtual_goods.html">CrystalVirtualGoods</a> *)&nbsp;</td><td class="memItemRight" valign="bottom">+ <a class="el" href="interface_crystal_virtual_goods.html#a1e0712415ffa8ae8c7a0eeb22cd425ae">sharedInstance</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the shared singleton instance of <a class="el" href="interface_crystal_virtual_goods.html">CrystalVirtualGoods</a>.  <a href="#a1e0712415ffa8ae8c7a0eeb22cd425ae"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad177f3f221b96969b2d315819869a50b"></a><!-- doxytag: member="CrystalVirtualGoods::_delegate" ref="ad177f3f221b96969b2d315819869a50b" args="" -->
id&lt; <a class="el" href="protocol_crystal_virtual_goods_delegate-p.html">CrystalVirtualGoodsDelegate</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>_delegate</b></td></tr>
<tr><td colspan="2"><h2><a name="properties"></a>
Properties</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">NSDictionary *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_crystal_virtual_goods.html#a3b6180d7d33e13268d6d11cab7ea1bbd">goods</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">NSDictionary *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_crystal_virtual_goods.html#aa92860ca957de2370e91eee11edc662e">balances</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">id&lt; <a class="el" href="protocol_crystal_virtual_goods_delegate-p.html">CrystalVirtualGoodsDelegate</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="interface_crystal_virtual_goods.html#a0723119a9d17cc8a6ea4b909af24981f">delegate</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>This class is intended to be used in conjunction with the <a class="el" href="interface_crystal_player.html" title="The interface to the Crystal gifting functionality and player info This class updates automatically f...">CrystalPlayer</a> class, as some of it's properties (i.e. isCrystalUser) preclude the use of this class. While the Crystal SDK makes every effort to keep the <a class="el" href="interface_crystal_virtual_goods.html">CrystalVirtualGoods</a> class up-to-date on the server side it is ultimately the responsibility of the developer to ensure that the state of goods and currencies is maintained on the user-facing side. The <a class="el" href="interface_crystal_virtual_goods.html">CrystalVirtualGoods</a> class is intended to provide a representation of the data on the server and no attempt is made to ensure that changes are recorded within the client SDK. </p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ad5b441744dd3b2a7bb36380b9a0ad9ca"></a><!-- doxytag: member="CrystalVirtualGoods::postBalances:" ref="ad5b441744dd3b2a7bb36380b9a0ad9ca" args="(NSDictionary *balances)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (void) postBalances: </td>
          <td></td>
          <td class="paramtype">(NSDictionary *)&nbsp;</td>
          <td class="paramname"> <em>balances</em></td>
          <td>&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Post changes to the user's balances back to the server Use this method to post one or more changes to the user's wallet balances to the server. Changes will only be made to the balances that are supplied, and more than one balance can be updated at once. There is no need to replicate the information stored in the balances property in full. To avoid server load it is recommended to combine changes into one call by adding the info to the same dictionary. When the virtual currencies have been updated the client will be informed via crystalVirtualGoodsInfoUpdatedWithSuccess: and the results reflected in the goods property. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>balances</em>&nbsp;</td><td>The format of the information supplied is a dictionary, where the key is the currency ID (NSString) and the value is the balance (NSNumber). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a3c492df8fcf36517289f4986a0e643ba"></a><!-- doxytag: member="CrystalVirtualGoods::postGoods:" ref="a3c492df8fcf36517289f4986a0e643ba" args="(NSDictionary *goods)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (void) postGoods: </td>
          <td></td>
          <td class="paramtype">(NSDictionary *)&nbsp;</td>
          <td class="paramname"> <em>goods</em></td>
          <td>&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Post changes to the user's virtual goods record back to the server Use this method to post one or more changes to the user's virtual goods to the server. Changes will only be made to the virtual good that are supplied, and more than one virtual good can be updated at once. There is no need to replicate the information stored in the goods property in full. To avoid server load it is recommended to combine changes into one call by adding the info to the same dictionary. To remove the good from the user supply a 0 for the number of goods owned. When the virtual goods have been updated the client will be informed via crystalVirtualGoodsInfoUpdatedWithSuccess: and the results reflected in the goods property. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>goods</em>&nbsp;</td><td>The format of the information supplied is a dictionary, where the key is the virtual good ID (NSString) and the value is the number of goods owned (NSNumber). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a02e594e54c25cec743faf73d61d84537"></a><!-- doxytag: member="CrystalVirtualGoods::postGoods:andBalances:" ref="a02e594e54c25cec743faf73d61d84537" args="(NSDictionary *goods,[andBalances] NSDictionary *balances)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (void) postGoods: </td>
          <td></td>
          <td class="paramtype">(NSDictionary *)&nbsp;</td>
          <td class="paramname"> <em>goods</em></td>
        </tr>
        <tr>
          <td class="paramkey">andBalances:</td>
          <td></td>
          <td class="paramtype">(NSDictionary *)&nbsp;</td>
          <td class="paramname"> <em>balances</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Post both goods and balances changes to the server Where the client needs to post changes to both currencies and goods it is recommended that it uses this method to avoid excessive server load. </p>

</div>
</div>
<a class="anchor" id="a90d3d0cae26cf956cbe9ff6831206b67"></a><!-- doxytag: member="CrystalVirtualGoods::setLockedGoods:" ref="a90d3d0cae26cf956cbe9ff6831206b67" args="(NSSet *lockedGoods)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (void) setLockedGoods: </td>
          <td></td>
          <td class="paramtype">(NSSet *)&nbsp;</td>
          <td class="paramname"> <em>lockedGoods</em></td>
          <td>&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set a list of goods that are not selectable and are shown with a 'locked' icon in the Crystal UI This method works differently from postGoods: and postBalances: in that it's not possible to 'update' items peacemeal. The client must send all locked goods in one call, and can remove the locks by passing nil as the parameter. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>lockedGoods</em>&nbsp;</td><td>An NSSet of NSString good IDs to lock or nil to remove any locks </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a1e0712415ffa8ae8c7a0eeb22cd425ae"></a><!-- doxytag: member="CrystalVirtualGoods::sharedInstance" ref="a1e0712415ffa8ae8c7a0eeb22cd425ae" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">+ (<a class="el" href="interface_crystal_virtual_goods.html">CrystalVirtualGoods</a>*) sharedInstance </td>
          <td></td>
          <td class="paramname"></td>
          <td>&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the shared singleton instance of <a class="el" href="interface_crystal_virtual_goods.html">CrystalVirtualGoods</a>. </p>

</div>
</div>
<a class="anchor" id="a00d41c367f983e89b1370f947bbf8ae6"></a><!-- doxytag: member="CrystalVirtualGoods::startUpdating" ref="a00d41c367f983e89b1370f947bbf8ae6" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (void) startUpdating </td>
          <td></td>
          <td class="paramname"></td>
          <td>&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Instructs the SDK to start keeping the <a class="el" href="interface_crystal_player.html" title="The interface to the Crystal gifting functionality and player info This class updates automatically f...">CrystalPlayer</a> class up-to-date with the current player's info Because this method initiates network traffic and server load it is important that apps refrain from calling the method unless virtual goods and currencies are implemented. </p>

</div>
</div>
<a class="anchor" id="ad628cda33c85c0ea8a932332f06a1abf"></a><!-- doxytag: member="CrystalVirtualGoods::updateNow" ref="ad628cda33c85c0ea8a932332f06a1abf" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (void) updateNow </td>
          <td></td>
          <td class="paramname"></td>
          <td>&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Instructs the SDK to update the <a class="el" href="interface_crystal_virtual_goods.html">CrystalVirtualGoods</a> info as soon as possible Ordinarily any activity relating to virtual goods or currencies inside the Crystal UI will automatically instruct <a class="el" href="interface_crystal_virtual_goods.html">CrystalVirtualGoods</a> to update itself. The same is true when using APIs like postGoods:. If a post fails the client should always retry via the post calls and not call updateNow. updateNow will retrieve updated information from the server and any information previously posted will be lost. It should be rare that the client will need to call this method but it is added for completeness. </p>

</div>
</div>
<a class="anchor" id="a9486d5f488eb962f401815daff86811f"></a><!-- doxytag: member="CrystalVirtualGoods::virtualGoodsInfoIsUpToDate" ref="a9486d5f488eb962f401815daff86811f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (BOOL) virtualGoodsInfoIsUpToDate </td>
          <td></td>
          <td class="paramname"></td>
          <td>&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns YES if the info for the curent player's virtual goods info is up-to-date Crystal will make every effort to keep the data up-to-date, so as long as the device has an Internet connection it should be rare that this method returns NO. </p>

</div>
</div>
<hr/><h2>Property Documentation</h2>
<a class="anchor" id="aa92860ca957de2370e91eee11edc662e"></a><!-- doxytag: member="CrystalVirtualGoods::balances" ref="aa92860ca957de2370e91eee11edc662e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (NSDictionary*) balances<code> [read, assign]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the balances of any virtual currencies owned by the user. Will return nil if no currencies are owned. Will return a dictionary of balances otherwise, where the key is the currency ID (NSString) and the value is the balance (NSNumber). </p>

</div>
</div>
<a class="anchor" id="a0723119a9d17cc8a6ea4b909af24981f"></a><!-- doxytag: member="CrystalVirtualGoods::delegate" ref="a0723119a9d17cc8a6ea4b909af24981f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (id&lt;<a class="el" href="protocol_crystal_virtual_goods_delegate-p.html">CrystalVirtualGoodsDelegate</a>&gt;) delegate<code> [read, write, assign]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="protocol_crystal_player_delegate-p.html" title="Delegate protocol for the CrystalPlayer class.">CrystalPlayerDelegate</a> for a description of this property. This property must be set to <a class="el" href="group__get.html">Getting an array of achievements unlocked</a> notified when the info in <a class="el" href="interface_crystal_virtual_goods.html">CrystalVirtualGoods</a> is updated. It is the responsibility of the client to ensure that the object set as the <a class="el" href="interface_crystal_virtual_goods.html#a0723119a9d17cc8a6ea4b909af24981f">delegate</a> remains valid for the duration of the Crystal session. </dd></dl>

</div>
</div>
<a class="anchor" id="a3b6180d7d33e13268d6d11cab7ea1bbd"></a><!-- doxytag: member="CrystalVirtualGoods::goods" ref="a3b6180d7d33e13268d6d11cab7ea1bbd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">- (NSDictionary*) goods<code> [read, assign]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the virtual goods owned by the user. Will return nil if no goods are owned. Will return a dictionary of goods otherwise, where the key is the virtual good ID (NSString) and the value is the number of goods owned (NSNumber). </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="_crystal_virtual_goods_8h_source.html">CrystalVirtualGoods.h</a></li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Thu Mar 24 2011 11:51:14 for Crystal SDK for iOS by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
